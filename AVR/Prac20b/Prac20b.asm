.include "m32def.inc"
LDI R21,0X00
MOV R22,R21
LDI ZH,HIGH(DAT<<1)
LDI ZL,LOW(DAT<<1)
LDI R16,0XFF
OUT DDRC,R16
SBI DDRD,0
SBI DDRD,1
SBI DDRD,2
LDI R22,0X38
CALL COMM
LDI R22,0X0E
CALL COMM
LDI R22,0X06
CALL COMM
LDI R22,0X01
CALL COMM
CALL DELAY

ABC: LPM R17,Z+
	 CPI R17,0X00
	 BREQ REP1
	 INC R21
	 CPI R21,0X10
	 BREQ XYZ

XYZ1: CALL DATA
	  JMP ABC
REP1: JMP REP1

XYZ: LDI R22,0XC0
	 CALL COMM
	 JMP XYZ1

COMM: OUT PORTC,R22
	  CBI PORTD,0
	  CBI PORTD,1
	  SBI PORTD,2
	  CALL DELAY
	  CBI PORTD,2
	  RET

DATA: OUT PORTC,R17
      SBI PORTD,0
	  CBI PORTD,1
	  SBI PORTD,2
	  CALL DELAY
	  CBI PORTD,2
	  RET

DELAY: LDI R19,0XFF
  REP2:LDI R20,0X58
  REP: DEC R20
       BRNE REP
	   DEC R19
	   BRNE REP2
	   RET

DAT:
.DB "MICROCONTROLLER AND INTERFACING",0
